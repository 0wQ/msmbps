var _createClass=function(){function c(a,b){for(var d=0;d<b.length;d++){var c=b[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(a,b,d){b&&c(a.prototype,b);d&&c(a,d);return a}}();function _toConsumableArray(c){if(Array.isArray(c)){for(var a=0,b=Array(c.length);a<c.length;a++)b[a]=c[a];return b}return Array.from(c)}
function _classCallCheck(c,a){if(!(c instanceof a))throw new TypeError("Cannot call a class as a function");}function _possibleConstructorReturn(c,a){if(!c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!==typeof a&&"function"!==typeof a?c:a}
function _inherits(c,a){if("function"!==typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function, not "+typeof a);c.prototype=Object.create(a&&a.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}});a&&(Object.setPrototypeOf?Object.setPrototypeOf(c,a):c.__proto__=a)}
var Bar=function(c){function a(){_classCallCheck(this,a);return _possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).apply(this,arguments))}_inherits(a,c);_createClass(a,[{key:"render",value:function(){return React.createElement("div",{className:"bar",style:{background:"rgb("+(0>=this.props.milliseconds?0:Math.floor(this.props.milliseconds/this.props.maxMilliseconds*200))+","+(0>=this.props.milliseconds?255:Math.floor(255-this.props.milliseconds/this.props.maxMilliseconds*128))+
",0)",width:(0>=this.props.milliseconds?0:Math.floor(this.props.milliseconds/this.props.maxMilliseconds*200))+"px"}})}}]);return a}(React.Component),Milliseconds=function(c){function a(){_classCallCheck(this,a);return _possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).apply(this,arguments))}_inherits(a,c);_createClass(a,[{key:"render",value:function(){return React.createElement("span",{className:"milliseconds"},0==this.props.milliseconds?"...":0>this.props.milliseconds?-this.props.milliseconds+
"/5":this.props.milliseconds+"ms")}}]);return a}(React.Component),Tip=function(c){function a(){_classCallCheck(this,a);return _possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).apply(this,arguments))}_inherits(a,c);_createClass(a,[{key:"render",value:function(){return React.createElement("span",{className:"tip"},this.props.downloadText)}}]);return a}(React.Component),Name=function(c){function a(b){_classCallCheck(this,a);b=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,
b));b.handleClick=b.handleClick.bind(b);return b}_inherits(a,c);_createClass(a,[{key:"handleClick",value:function(){var b=this.props.url,a=b.indexOf("://")+3,c=b.indexOf("/",a);b=b.substring(a,c);this.props.showNotice(b);void 0!=this.props.download&&(this.props.allProvidersFinished()||this.props.showMessage(),window.open(this.props.download,"_blank"))}},{key:"render",value:function(){return React.createElement("span",{className:"name",onClick:this.handleClick,style:{cursor:void 0==this.props.download?
"help":"pointer"},download:this.props.download},this.props.locationName,React.createElement(Tip,{className:"tip",downloadText:void 0==this.props.download?"Show Server":"Server&Download"}))}}]);return a}(React.Component),Line=function(c){function a(){_classCallCheck(this,a);return _possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).apply(this,arguments))}_inherits(a,c);_createClass(a,[{key:"render",value:function(){return React.createElement("div",{className:"line",style:{transform:"translateY("+
20*this.props.index+"px)",zIndex:this.props.number-this.props.index+1}},React.createElement(Milliseconds,{milliseconds:this.props.milliseconds}),React.createElement(Name,{locationName:this.props.name,download:this.props.download,allProvidersFinished:this.props.allProvidersFinished,showMessage:this.props.showMessage,url:this.props.url,showNotice:this.props.showNotice}),React.createElement(Bar,{milliseconds:this.props.milliseconds,maxMilliseconds:this.props.maxMilliseconds}))}}]);return a}(React.Component),
List=function(c){function a(b){_classCallCheck(this,a);b=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,b));b.state={millisecondsOfTargets:[],rankList:[]};b.data={img:document.createElement("img"),testTimeOut:!1,timeOutId:null,currentIndex:0,countOfLoad:0,startTime:0,endTime:0,minOfCurrentTarget:6E4};document.body.appendChild(b.data.img);b.lineRef=[];for(var c=0;c<=Object.keys(b.props.targets).length-1;c++)b.lineRef[c]=React.createRef();for(c=0;c<=Object.keys(b.props.targets).length-
1;c++)b.state.millisecondsOfTargets[c]=0;for(c=0;c<=Object.keys(b.props.targets).length-1;c++)b.state.rankList[c]={id:c,rank:c,milliseconds:6E4+c};b.onTimeOut=b.onTimeOut.bind(b);b.onLoaded=b.onLoaded.bind(b);return b}_inherits(a,c);_createClass(a,[{key:"updateCount",value:function(){var b=this.state.millisecondsOfTargets.slice();b[this.data.currentIndex]=-this.data.countOfLoad;this.setState({millisecondsOfTargets:b})}},{key:"onTimeOut",value:function(){var b=this.data.img.onerror;this.data.img.onerror=
null;this.data.img.src="";setTimeout(b,1)}},{key:"clearThisTimeOut",value:function(){try{clearTimeout(this.data.timeOutId)}catch(b){console.log("clearThisTimeOut ERROR")}}},{key:"prepareTimeOut",value:function(){this.clearThisTimeOut();this.data.timeOutId=setTimeout(this.onTimeOut,6E3)}},{key:"doNextTest",value:function(){var b=this.lineRef[this.data.currentIndex];this.data.countOfLoad++;this.updateCount();this.data.startTime=(new Date).getTime();this.data.img.onerror=this.onLoaded;this.prepareTimeOut();
this.data.testTimeOut||(this.data.img.src=b.current.props.url+Math.random())}},{key:"doNextTarget",value:function(){this.data.currentIndex++;if(this.data.currentIndex>this.lineRef.length-1)this.props.providerFinished(),this.clearThisTimeOut();else{var b=this.lineRef[this.data.currentIndex];this.data.countOfLoad=1;this.updateCount();this.data.startTime=(new Date).getTime();this.data.img.onerror=this.onLoaded;this.prepareTimeOut();this.data.testTimeOut||(this.data.img.src=b.current.props.url+Math.random())}}},
{key:"onLoaded",value:function(){if(1==this.data.countOfLoad)this.doNextTest();else{this.data.endTime=(new Date).getTime();var b=this.data.endTime-this.data.startTime;b<this.data.minOfCurrentTarget&&(this.data.minOfCurrentTarget=b);if(5==this.data.countOfLoad){b=this.state.millisecondsOfTargets.slice();b[this.data.currentIndex]=this.data.minOfCurrentTarget;this.setState({millisecondsOfTargets:b});var a=JSON.parse(JSON.stringify(this.state.rankList));a[this.data.currentIndex].milliseconds=this.data.minOfCurrentTarget;
b=JSON.parse(JSON.stringify(a));b.sort(function(b,a){return b.milliseconds-a.milliseconds});a=JSON.parse(JSON.stringify(a));for(var c=0;c<=a.length-1;c++)for(var f=a[c].id,e=0;e<=b.length;e++)if(f==b[e].id){a[c].rank=e;break}this.setState({rankList:a});this.data.minOfCurrentTarget=6E4;this.doNextTarget()}else this.doNextTest()}}},{key:"componentDidMount",value:function(){var b=this.lineRef[this.data.currentIndex];this.data.countOfLoad=1;this.updateCount();this.data.startTime=(new Date).getTime();
this.data.img.onerror=this.onLoaded;this.prepareTimeOut();this.data.testTimeOut||(this.data.img.src=b.current.props.url+Math.random())}},{key:"render",value:function(){return React.createElement("div",{className:"list"},this.props.targets.map(function(b,a){return React.createElement(Line,{name:b.name,key:a,url:b.url,download:b.download,milliseconds:this.state.millisecondsOfTargets[a],maxMilliseconds:Math.max.apply(Math,_toConsumableArray(this.state.millisecondsOfTargets)),index:this.state.rankList[a].rank,
number:this.state.rankList.length,allProvidersFinished:this.props.allProvidersFinished,showMessage:this.props.showMessage,showNotice:this.props.showNotice,ref:this.lineRef[a]})}.bind(this)))}}]);return a}(React.Component),Message=function(c){function a(b){_classCallCheck(this,a);b=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,b));b.reload=b.reload.bind(b);return b}_inherits(a,c);_createClass(a,[{key:"reload",value:function(){location.reload()}},{key:"render",value:function(){return React.createElement("div",
{className:"message",style:{visibility:this.props.messageVisible?"visible":"hidden"}},"During download, ping might not be precise.",React.createElement("br",null),React.createElement("br",null),React.createElement("br",null),React.createElement("div",{style:{textAlign:"center"}},React.createElement("a",{href:"javascript:void(0);",onClick:this.reload},"Reload"),React.createElement("span",null,"\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0"),React.createElement("a",{href:"javascript:void(0);",onClick:this.props.hideMessage},
"Close")))}}]);return a}(React.Component),Notice=function(c){function a(){_classCallCheck(this,a);return _possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).apply(this,arguments))}_inherits(a,c);_createClass(a,[{key:"render",value:function(){return React.createElement("div",{className:"notice",style:{visibility:this.props.noticeVisible?"visible":"hidden"}},React.createElement("textarea",{className:"server",readOnly:!0,value:this.props.server}),React.createElement("div",{style:{textAlign:"center"}},
React.createElement("span",{style:{fontStyle:"italic"}},"Copy server address",React.createElement("br",null),"for further testing"),React.createElement("br",null),React.createElement("br",null),React.createElement("a",{href:"javascript:void(0);",onClick:this.props.hideNotice},"Close")))}}]);return a}(React.Component),App=function(c){function a(b){_classCallCheck(this,a);b=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,b));b.state={allData:data,messageVisible:!1,
noticeVisible:!1,server:"abc"};b.data={countOfFinishedProviders:0};b.providerFinished=b.providerFinished.bind(b);b.allProvidersFinished=b.allProvidersFinished.bind(b);b.showMessage=b.showMessage.bind(b);b.hideMessage=b.hideMessage.bind(b);b.showNotice=b.showNotice.bind(b);b.hideNotice=b.hideNotice.bind(b);return b}_inherits(a,c);_createClass(a,[{key:"providerFinished",value:function(){this.data.countOfFinishedProviders++}},{key:"allProvidersFinished",value:function(){return this.data.countOfFinishedProviders==
Object.keys(this.state.allData).length}},{key:"showMessage",value:function(){this.setState({messageVisible:!0})}},{key:"hideMessage",value:function(){this.setState({messageVisible:!1})}},{key:"showNotice",value:function(a){this.setState({server:a,noticeVisible:!0});setTimeout(function(){for(var a=document.getElementsByClassName("server"),b=0;b<=a.length-1;b++)a[b].select()},500)}},{key:"hideNotice",value:function(){this.setState({noticeVisible:!1})}},{key:"render",value:function(){return React.createElement("div",
null,React.createElement(Message,{messageVisible:this.state.messageVisible,hideMessage:this.hideMessage}),React.createElement(Notice,{noticeVisible:this.state.noticeVisible,hideNotice:this.hideNotice,server:this.state.server}),Object.keys(this.state.allData).map(function(a,c){return React.createElement("div",{className:"section",key:c,style:{height:20*this.state.allData[a].length+30+"px"}},React.createElement("h3",null,a),React.createElement(List,{providerFinished:this.providerFinished,allProvidersFinished:this.allProvidersFinished,
showMessage:this.showMessage,showNotice:this.showNotice,targets:this.state.allData[a]}))}.bind(this)))}}]);return a}(React.Component);function main(){ReactDOM.render(React.createElement(App,null),document.getElementById("result"))};